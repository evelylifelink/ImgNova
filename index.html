<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Mining Zone</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
    <style>
        :root {
            --bg-color: #111111; --card-bg-color: rgba(30, 30, 30, 0.85); --text-primary: #f5f5f5;
            --text-secondary: #aaaaaa; --accent-primary: #FFA500;
            --accent-gradient: linear-gradient(135deg, #FFB347, #FF6347);
            --border-color: rgba(255, 255, 255, 0.1); --shadow-color: rgba(0, 0, 0, 0.3);
            --success-color: #4CAF50; --error-color: #f44336; --pending-color: #FFB74D;
        }
        body.light-mode {
            --bg-color: #f0f2f5; --card-bg-color: rgba(255, 255, 255, 0.95); --text-primary: #111111;
            --text-secondary: #666666; --border-color: rgba(0, 0, 0, 0.1);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Poppins', sans-serif; background-color: var(--bg-color);
            color: var(--text-primary); overflow-x: hidden;
            background-image: url('https://i.ibb.co/23cWvy1p/1000105864.jpg');
            background-size: cover; background-position: center center; background-attachment: fixed;
            padding-bottom: 75px; /* Space for bottom nav */
        }
        .app-container { max-width: 600px; margin: 0 auto; padding: 15px; }

        /* --- Header --- */
        .app-header {
            display: flex; justify-content: space-between; align-items: center; padding: 15px;
            background-color: var(--card-bg-color); backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color); position: sticky; top: 0; z-index: 1000;
        }
        .user-profile { display: flex; align-items: center; gap: 10px; }
        .profile-pic { width: 42px; height: 42px; border-radius: 50%; border: 2px solid var(--accent-primary); object-fit: cover; }
        .user-info .name { font-weight: 600; }
        .user-info .id { font-size: 12px; color: var(--text-secondary); }
        .header-right { display: flex; align-items: center; gap: 15px; }
        .theme-switcher { width: 28px; height: 28px; cursor: pointer; color: var(--text-secondary); }
        .theme-switcher .icon { display: none; }
        body.light-mode .theme-switcher .moon-icon { display: block; }
        body:not(.light-mode) .theme-switcher .sun-icon { display: block; }
        
        /* Page Views */
        .page { display: none; animation: fadeIn 0.5s; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Common Styles */
        .card { 
            background-color: var(--card-bg-color); border-radius: 15px; padding: 20px;
            margin-bottom: 20px; backdrop-filter: blur(10px); border: 1px solid var(--border-color);
        }
        .btn { border: none; border-radius: 10px; background: var(--accent-gradient); color: white; font-size: 16px; font-weight: 600; cursor: pointer; padding: 10px 20px; display: inline-flex; align-items: center; justify-content: center; gap: 8px; transition: transform 0.2s; }
        .btn:hover { transform: translateY(-2px); }
        .btn:disabled { background: #555; cursor: not-allowed; opacity: 0.7; }
        .coin-icon { width: 18px; height: 18px; vertical-align: middle; margin-left: 5px; border-radius: 50%; }
        .page-header { display: flex; align-items: center; margin-bottom: 25px; position: relative; }
        .back-btn { font-size: 24px; color: var(--text-primary); cursor: pointer; z-index: 10; padding: 5px;}
        .header-title { font-size: 20px; font-weight: 600; color: var(--text-primary); text-align: center; position: absolute; left: 50px; right: 50px; }

        /* --- Bottom Navigation --- */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; right: 0; max-width: 600px; margin: 0 auto;
            display: flex; justify-content: space-around; background-color: var(--card-bg-color);
            padding: 10px 0; border-top: 1px solid var(--border-color); z-index: 1000;
        }
        .nav-item { flex-direction: column; align-items: center; color: var(--text-secondary); font-size: 12px; cursor: pointer; border: none; background: none; }
        .nav-item i { font-size: 20px; margin-bottom: 4px; }
        .nav-item.active { color: var(--accent-primary); }

        /* --- Mining Page --- */
        #mining-page .wallet-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        #mining-page .wallet-card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); padding: 15px; border-radius: 12px; text-align: center; }
        #mining-page .wallet-card .label { font-size: 13px; color: var(--text-secondary); margin-bottom: 8px; display: flex; align-items: center; justify-content: center; gap: 8px; }
        #mining-page .wallet-card .label img { width: 22px; height: 22px; border-radius: 50%; }
        #mining-page .wallet-card .label i { font-size: 18px; color: var(--accent-primary); width: 20px; }
        #mining-page .wallet-card .value { font-size: 22px; font-weight: 700; color: var(--text-primary); }
        #mining-page .small-wallets .wallet-card .value { font-size: 18px; }
        #mining-page .mining-section { text-align: center; padding: 20px; }
        #mining-page .mining-coin-wrapper { position: relative; width: 120px; height: 120px; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; }
        #mining-page .mining-coin-wrapper::before { content: ''; position: absolute; top: -5px; left: -5px; width: 130px; height: 130px; background: conic-gradient(from 180deg at 50% 50%, #FFB347, #FF6347, #FFA500, #FFB347); border-radius: 50%; animation: rotate 4s linear infinite; }
        @keyframes rotate { to { transform: rotate(360deg); } }
        #mining-page .mining-coin { width: 100%; height: 100%; border-radius: 50%; animation: pulse 2s infinite ease-in-out; border: 3px solid var(--bg-color); }
        @keyframes pulse { 0%, 100% { transform: scale(0.95); } 50% { transform: scale(1.05); } }
        #mining-page #mine-now-btn { font-size: 18px; padding: 12px 25px; border-radius: 50px; margin: 15px 0; }
        #mining-page .mining-controls { display: flex; justify-content: space-between; align-items: center; max-width: 250px; margin: 0 auto; }
        #mining-page .action-btn { background: var(--card-bg-color); border: 1px solid var(--border-color); color: var(--text-secondary); font-size: 18px; cursor: pointer; width: 45px; height: 45px; border-radius: 50%; display:flex; align-items:center; justify-content:center; }
        #mining-page .referral-box .title { font-weight: 600; margin-bottom: 10px; }
        #mining-page .ref-input-group { display: flex; background: var(--bg-color); border-radius: 8px; padding: 5px; margin-bottom: 10px; }
        #mining-page .ref-input-group input { flex-grow: 1; background: transparent; border: none; color: var(--text-primary); padding: 8px; font-size: 14px; }
        #mining-page .ref-input-group input:focus { outline: none; }
        #mining-page .copy-btn { padding: 8px 15px; font-size: 14px; background: var(--accent-primary); border: none; border-radius: 6px; color: white; cursor: pointer; }
        #mining-page .video-thumbnail { cursor: pointer; position: relative; border-radius: 12px; overflow: hidden; }
        #mining-page .play-icon { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 50px; color: rgba(255,255,255,0.8); }
        #mining-page .footer-section p { color: var(--text-secondary); line-height: 1.7; margin-top: 10px; }
        #mining-page .footer-links { margin: 20px 0; }
        #mining-page .footer-links a { color: var(--accent-primary); text-decoration: none; margin: 0 10px; }
        #mining-page .social-icons { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
        #mining-page .social-icons a { color: var(--text-secondary); font-size: 22px; text-decoration: none; }
        
        /* --- Gift Page --- */
        #gift-page .gift-card { text-align: center; padding: 25px; }
        #gift-page .gift-card h1 { font-size: 24px; margin-bottom: 10px; color: var(--accent-primary); }
        #gift-page .gift-card p { color: var(--text-secondary); margin-bottom: 20px; font-size: 14px; }
        #gift-page .gift-icon { font-size: 60px; margin-bottom: 20px; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-20px); } 60% { transform: translateY(-10px); } }
        #gift-page .claim-form input { width: 100%; padding: 15px; border-radius: 10px; border: 1px solid var(--border-color); background-color: var(--bg-color); color: var(--text-primary); font-size: 16px; text-align: center; margin-bottom: 15px; }
        #gift-page .claim-form button { width: 100%; padding: 15px; }
        #gift-page .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        #gift-page .stat-card { padding: 15px; text-align: center; }
        #gift-page .stat-value { font-size: 22px; font-weight: 700; color: var(--accent-primary); }
        #gift-page .stat-label { font-size: 12px; color: var(--text-secondary); }
        #gift-page .history-controls, #deposit-page .history-controls { display: flex; gap: 10px; margin-bottom: 20px; }
        #gift-page .history-btn, #deposit-page .history-btn { flex: 1; padding: 12px; border: 1px solid var(--border-color); border-radius: 10px; background-color: var(--card-bg-color); color: var(--text-secondary); font-weight: 600; cursor: pointer; }
        #gift-page .history-btn.active, #deposit-page .history-btn.active { background: var(--accent-primary); color: white; }
        #gift-page .history-list-item, #deposit-page .history-list-item { display: flex; align-items: center; gap: 12px; background-color: var(--card-bg-color); padding: 12px; border-radius: 10px; margin-bottom: 10px; }
        #gift-page .history-list-item img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }
        #gift-page .history-info, #deposit-page .history-info { flex-grow: 1; }
        #gift-page .history-info .name { font-weight: 600; }
        #gift-page .history-info .details, #deposit-page .history-info .details { font-size: 12px; color: var(--text-secondary); }
        #gift-page .history-amount { font-size: 18px; font-weight: 700; color: var(--success-color); display: flex; align-items: center; gap: 5px; }
        #gift-page .history-amount img { width: 20px; height: 20px; border-radius: 50%; }

        /* --- Deposit Page --- */
        #deposit-page .balance-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        #deposit-page .balance-card { padding: 20px; text-align: center; }
        #deposit-page .balance-card .icon svg { width: 28px; height: 28px; margin-bottom: 8px; color: var(--accent-primary); }
        #deposit-page .balance-value { font-size: 22px; font-weight: 700; color: var(--text-primary); }
        #deposit-page .balance-label { font-size: 13px; color: var(--text-secondary); }
        #deposit-page .action-btn { display: block; text-align: center; width: 100%; padding: 15px; font-size: 18px; font-weight: 700; margin-bottom: 25px; }
        #deposit-page .history-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        #deposit-page .history-icon svg { width: 20px; height: 20px; }
        #deposit-page .history-icon.deposit { background-color: rgba(76, 175, 80, 0.2); color: var(--success-color); }
        #deposit-page .history-amount { font-size: 18px; font-weight: 700; }
        #deposit-page .status-badge { padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: 600; text-transform: uppercase; }
        #deposit-page .status-badge.approved { background-color: rgba(76, 175, 80, 0.2); color: var(--success-color); }
        #deposit-page .status-badge.pending { background-color: rgba(255, 183, 77, 0.2); color: var(--pending-color); }
        #deposit-page .status-badge.rejected { background-color: rgba(244, 67, 54, 0.2); color: var(--error-color); }
        #deposit-page .form-group { margin-bottom: 15px; }
        #deposit-page .form-group label { display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 14px; }
        #deposit-page .form-group input { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-color); background-color: var(--bg-color); color: var(--text-primary); font-size: 16px; }
        #deposit-page .selection-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        #deposit-page .selection-btn { padding: 15px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--card-bg-color); color: var(--text-primary); cursor: pointer; font-weight: 500; font-size: 16px; }
        #deposit-page .payment-details { background-color: var(--card-bg-color); padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid var(--accent-primary); }
        #deposit-page .payment-details p { margin-bottom: 8px; color: var(--text-secondary); }
        #deposit-page .payment-details span { font-weight: 600; color: var(--text-primary); word-break: break-all; }
        
        /* --- Lottery Page --- */
        #lottery-page .wallet-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        #lottery-page .wallet-card { background-color: rgba(0,0,0,0.2); padding: 15px; text-align: center; }
        #lottery-page .lottery-card { border: 1px solid var(--border-color); border-radius: 15px; overflow: hidden; margin-bottom: 20px; }
        #lottery-page .lottery-header { display: flex; align-items: center; gap: 15px; padding: 15px; background: rgba(0,0,0,0.2); }
        #lottery-page .lottery-icon { font-size: 32px; color: var(--accent-primary); }
        #lottery-page .lottery-name { font-size: 20px; font-weight: 700; background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        #lottery-page .lottery-body { padding: 20px; }
        #lottery-page .lottery-details { display: flex; justify-content: space-between; margin-bottom: 20px; }
        #lottery-page .detail-item { text-align: center; }
        #lottery-page .prize-list { list-style: none; margin-bottom: 25px; }
        #lottery-page .prize-item { display: flex; align-items: center; background: rgba(0,0,0,0.15); border-radius: 8px; padding: 10px 15px; margin-bottom: 8px; }
        #lottery-page .prize-item .rank-icon { font-size: 20px; margin-right: 15px; }
        #lottery-page .prize-item .prize-info { flex-grow: 1; }
        #lottery-page .prize-item .reward { font-weight: 600; }
        #lottery-page .prize-item .gift { font-size: 12px; color: var(--text-secondary); }
        #lottery-page .prize-item:nth-child(1) .rank-icon { color: #FFD700; }
        #lottery-page .prize-item:nth-child(2) .rank-icon { color: #C0C0C0; }
        #lottery-page .prize-item:nth-child(3) .rank-icon { color: #CD7F32; }
        #lottery-page .purchase-btn { width: 100%; font-size: 18px; padding: 12px; }

        /* --- Super Tasks Page --- */
        #tasks-page .task-card { overflow: hidden; }
        #tasks-page .task-card-image { width: 100%; height: 120px; object-fit: cover; }
        #tasks-page .task-card-content { padding: 20px; }
        #tasks-page .task-card-title { font-size: 1.2rem; font-weight: 600; margin-bottom: 8px; }
        #tasks-page .task-card-desc { color: var(--text-secondary); margin-bottom: 15px; font-size: 0.95rem; line-height: 1.6; }
        #tasks-page .task-card-footer { display: flex; justify-content: space-between; align-items: center; }
        #tasks-page .task-reward { font-weight: 700; font-size: 1.1rem; color: var(--accent-primary); }
        #tasks-page .task-limit { font-size: 0.9rem; color: var(--text-secondary); }
        #tasks-page .task-details-image { width: 100%; height: 150px; object-fit: cover; border-radius: 15px; margin-bottom: 20px; }
        #tasks-page .task-details-desc { font-size: 1rem; line-height: 1.7; margin-bottom: 25px; color: var(--text-secondary); }
        #tasks-page .form-group { margin-bottom: 15px; }
        #tasks-page .form-group label { display: block; margin-bottom: 8px; font-size: 0.9rem; font-weight: 500; }
        #tasks-page .form-group textarea, #tasks-page .form-group input { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-color); background-color: var(--bg-color); color: var(--text-primary); font-size: 1rem; }
        #tasks-page .history-item { padding: 15px; border-bottom: 1px solid var(--border-color); }
        #tasks-page .history-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        #tasks-page .history-title { font-weight: 600; font-size: 1.1rem; }
        #tasks-page .status-badge { padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; text-transform: capitalize; }
        #tasks-page .status-pending { background-color: rgba(255, 183, 77, 0.2); color: var(--pending-color); }
        #tasks-page .status-approved { background-color: rgba(76, 175, 80, 0.2); color: var(--success-color); }
        #tasks-page .status-rejected { background-color: rgba(244, 67, 54, 0.2); color: var(--error-color); }
        #tasks-page .rejection-reason { background-color: rgba(244, 67, 54, 0.1); padding: 10px; border-radius: 8px; margin-top: 10px; font-size: 0.9rem; border-left: 3px solid var(--error-color); }


        /* --- Modals --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1001; display: none; align-items: center; justify-content: center; padding: 15px; }
        .modal-overlay.show { display: flex; }
        .modal-content { background-color: var(--card-bg-color); padding: 25px; border-radius: 15px; width: 100%; max-width: 450px; position: relative; text-align: center; }
        .modal-close-btn { position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 2rem; color: var(--text-secondary); cursor: pointer; }
        #video-modal .modal-content { padding: 10px; aspect-ratio: 16 / 9; }
        #video-iframe { width: 100%; height: 100%; border: none; border-radius: 10px; }
        #welcome-notice-modal img, #task-modal img { width: 100%; max-height: 180px; object-fit: cover; border-radius: 10px; margin-bottom: 15px; }
        #welcome-notice-modal h2, #task-modal h2 { color: var(--accent-primary); margin-bottom: 10px; }
        #welcome-notice-modal p, #task-modal p { color: var(--text-secondary); margin-bottom: 20px; line-height: 1.6; }
        #welcome-join-buttons { display: flex; flex-direction: column; gap: 10px; }
        #welcome-close-btn { margin-top: 15px; background: transparent; border: 1px solid var(--error-color); color: var(--error-color); }
        #task-timer { font-size: 2rem; font-weight: bold; color: var(--accent-primary); margin: 10px 0; }
        .notification { position: fixed; bottom: -100px; left: 50%; transform: translateX(-50%); color: white; padding: 12px 25px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); z-index: 2000; transition: all 0.5s ease-in-out; text-align: center; width: 90%; max-width: 480px; }
        .notification.show { bottom: 80px; }
    </style>
</head>
<body>
    <header class="app-header">
        <div class="user-profile">
            <img id="profile-pic" src="https://i.ibb.co/L0xJ182/placeholder.png" alt="Profile" class="profile-pic">
            <div class="user-info">
                <div id="user-name" class="name">Guest User</div>
                <div id="user-id" class="id">ID: Not Found</div>
            </div>
        </div>
        <div class="header-right">
            <div id="theme-switcher" class="theme-switcher">
                <svg class="sun-icon icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.106a.75.75 0 010 1.06l-1.591 1.59a.75.75 0 11-1.06-1.06l1.59-1.591a.75.75 0 011.06 0zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.894 17.894a.75.75 0 01-1.06 0l-1.59-1.591a.75.75 0 111.06-1.06l1.591 1.59a.75.75 0 010 1.061zM12 18.75a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0v-2.25a.75.75 0 01.75-.75zM6.106 17.894a.75.75 0 010-1.06l1.591-1.59a.75.75 0 111.06 1.06l-1.59 1.591a.75.75 0 01-1.06 0zM3.75 12a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h2.25a.75.75 0 01.75.75zM6.106 6.106a.75.75 0 011.06 0l1.59 1.591a.75.75 0 11-1.06 1.06L6.106 7.167a.75.75 0 010-1.06z"></path></svg>
                <svg class="moon-icon icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-3.833 2.067-7.17 5.168-8.972a.75.75 0 01.818.162z" clip-rule="evenodd"></path></svg>
            </div>
        </div>
    </header>
    
    <div class="app-container">
        <!-- Mining Page -->
        <div id="mining-page" class="page active">
             <div class="wallet-grid">
                <div class="wallet-card"><div class="label"><img src="https://i.ibb.co/Qjjn0jt4/1000105515.jpg"><span>Today's Mining</span></div><div id="today-mining-balance" class="value">0</div></div>
                <div class="wallet-card"><div class="label"><img src="https://i.ibb.co/Qjjn0jt4/1000105515.jpg"><span>Total Mining</span></div><div id="total-mining-balance" class="value">0</div></div>
            </div>
            <div class="card mining-section">
                <div class="mining-coin-wrapper"><img src="https://i.ibb.co/Qjjn0jt4/1000105515.jpg" alt="Mining Coin" class="mining-coin"></div>
                <button id="mine-now-btn" class="btn">Mine Now</button>
                <div class="mining-controls">
                    <button id="instructions-btn" class="action-btn"><i class="fas fa-question-circle"></i></button>
                    <button id="auto-mine-btn" class="action-btn" style="display: none;"><i class="fas fa-robot"></i></button>
                </div>
            </div>
            <div class="card youtube-section">
                 <h3 style="text-align: center; margin-bottom: 15px;">Tutorial Video</h3>
                 <div id="video-thumbnail" class="video-thumbnail">
                    <img src="https://img.youtube.com/vi/dQw4w9WgXcQ/0.jpg" alt="Video Thumbnail" style="width: 100%; border-radius: 12px;">
                    <i class="fas fa-play play-icon"></i>
                </div>
            </div>
            <div class="card referral-box">
                <div class="title">Your Referral Code</div>
                <div class="ref-input-group"><input type="text" id="ref-code-input" readonly value="..."><button class="copy-btn" data-target="ref-code-input">Copy</button></div>
                <div class="title">Your Referral Link</div>
                <div class="ref-input-group"><input type="text" id="ref-link-input" readonly value="..."><button class="copy-btn" data-target="ref-link-input">Copy</button></div>
            </div>
            <h3 style="margin-bottom: 15px; text-align: center; text-shadow: 0 1px 3px #000;">All Wallets</h3>
            <div class="wallet-grid small-wallets">
                <div class="wallet-card"><div class="label"><i class="fas fa-calendar-day"></i><span>Today Earning</span></div><div id="today-earning-balance" class="value">0</div></div>
                <div class="wallet-card"><div class="label"><i class="fas fa-wallet"></i><span>Main Balance</span></div><div id="main-balance" class="value">0</div></div>
                <div class="wallet-card"><div class="label"><i class="fas fa-list-check"></i><span>Task Earning</span></div><div id="task-earning-balance" class="value">0</div></div>
                <div class="wallet-card"><div class="label"><i class="fas fa-rectangle-ad"></i><span>Ads Earning</span></div><div id="ads-earning-balance" class="value">0</div></div>
                <div class="wallet-card"><div class="label"><i class="fas fa-gift"></i><span>Bonus Earning</span></div><div id="bonus-earning-balance" class="value">0</div></div>
                <div class="wallet-card"><div class="label"><i class="fas fa-ticket"></i><span>Lottery Earning</span></div><div id="lottery-earning-balance" class="value">0</div></div>
                <div class="wallet-card"><div class="label"><i class="fas fa-users"></i><span>Referral Balance</span></div><div id="referral-balance" class="value">0</div></div>
                <div class="wallet-card"><div class="label"><i class="fas fa-paper-plane"></i><span>Total Transfer</span></div><div id="transfer-balance" class="value">0</div></div>
            </div>
            <footer class="card footer-section">
                <h3>About Our Company</h3>
                <p>We are dedicated to providing the best service and experience for our users. Join our community and start earning today!</p>
                <div class="footer-links"><a id="privacy-policy-link" href="#">Privacy Policy</a><a id="terms-link" href="#">Terms & Conditions</a></div>
                <div id="social-icons" class="social-icons"></div>
            </footer>
        </div>

        <!-- Gift Page -->
        <div id="gift-page" class="page">
            <div class="card gift-card">
                <h1>Gift Code Bonus</h1>
                <p>Claim exciting bonuses using gift codes from the admin!</p>
                <div class="gift-icon">🎁</div>
                <form class="claim-form" id="claim-form">
                    <input type="text" id="gift-code-input" placeholder="Enter your gift code here" required>
                    <button type="submit" id="claim-btn" class="btn">Claim Now</button>
                </form>
            </div>
            <div class="card stats-grid">
                <div class="stat-card"><div id="today-total-coins" class="stat-value">0</div><div class="stat-label">Today's Total Bonus</div></div>
                <div class="stat-card"><div id="my-total-coins" class="stat-value">0</div><div class="stat-label">My Total Bonus</div></div>
            </div>
            <div class="history-controls">
                <button class="history-btn active" id="leaderboard-btn">Today's Leaderboard</button>
                <button class="history-btn" id="my-history-btn">My History</button>
            </div>
            <div id="gift-history-content" class="card"></div>
        </div>

        <!-- Deposit Page -->
        <div id="deposit-page" class="page">
             <div id="deposit-main-view">
                <div class="card balance-grid">
                    <div class="balance-card">
                        <div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10.463 3.536a2.25 2.25 0 013.074 0l6 5.25a2.25 2.25 0 01-1.537 3.964H6.002a2.25 2.25 0 01-1.537-3.964l6-5.25zM12 14.25a2.25 2.25 0 100 4.5 2.25 2.25 0 000-4.5zM3 15.75a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z"></path></svg></div>
                        <div id="deposit-balance" class="balance-value">0</div>
                        <div class="balance-label">ডিপোজিট ব্যালেন্স</div>
                    </div>
                    <div class="balance-card">
                        <div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3.375 3C2.339 3 1.5 3.84 1.5 4.875v.75c0 1.036.84 1.875 1.875 1.875h17.25c1.035 0 1.875-.84 1.875-1.875v-.75C22.5 3.839 21.66 3 20.625 3H3.375z"></path><path fill-rule="evenodd" d="M3.087 9l.54 9.176A3 3 0 006.62 21h10.757a3 3 0 002.995-2.824L20.913 9H3.087zm6.163 3.75A.75.75 0 0110 12h4a.75.75 0 010 1.5h-4a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg></div>
                        <div id="spent-balance" class="balance-value">0</div>
                        <div class="balance-label">মোট খরচ</div>
                    </div>
                </div>
                <button id="deposit-now-btn" class="action-btn btn">এখনই ডিপোজিট করুন</button>
                <div class="history-controls">
                    <button class="history-btn active" id="deposit-history-btn">ডিপোজিট হিস্টোরি</button>
                    <button class="history-btn" id="spending-history-btn">খরচের হিস্টোরি</button>
                </div>
                <div id="deposit-history-content" class="card"></div>
             </div>
             <div id="deposit-form-view" style="display:none;">
                <header class="page-header">
                    <div id="back-to-deposit-main" class="back-btn"><i class="fas fa-arrow-left"></i></div>
                    <h1 class="header-title">ডিপোজিট করুন</h1>
                </header>
                <div id="step1" class="page-step card">...</div>
                <div id="step2" class="page-step card">...</div>
                <div id="step3" class="page-step card">...</div>
             </div>
        </div>
        
        <!-- Lottery Page -->
        <div id="lottery-page" class="page">
            <div class="card notice-card">
                <p id="lottery-description">Welcome to the Lottery Zone! Participate for a chance to win big.</p>
            </div>
            <div class="card wallet-grid">
                <div class="wallet-card">
                    <div class="label">🏆 Lottery Winnings</div>
                    <div id="lottery-winnings-balance" class="value">0</div>
                </div>
                <div class="wallet-card">
                    <div class="label">🎟️ Tickets Purchased</div>
                    <div id="total-lotteries-purchased" class="value">0</div>
                </div>
            </div>
            <div id="lottery-list"></div>
        </div>

        <!-- Super Tasks Page -->
        <div id="tasks-page" class="page">
             <div id="tasks-main-view">
                <div class="history-controls">
                    <button class="history-btn active" data-tab="tasks">Tasks</button>
                    <button class="history-btn" data-tab="history">History</button>
                </div>
                <div id="tasks-content"></div>
                <div id="tasks-history-content" style="display: none;"></div>
             </div>
             <div id="tasks-details-view" style="display: none;">
                <header class="page-header">
                    <div id="back-to-tasks-main" class="back-btn"><i class="fas fa-arrow-left"></i></div>
                    <h1 class="header-title">Task Details</h1>
                </header>
                <main id="task-details-content"></main>
             </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-page="mining-page"><i class="fas fa-gavel"></i><span>Mine</span></button>
        <button class="nav-item" data-page="gift-page"><i class="fas fa-gift"></i><span>Gift</span></button>
        <button class="nav-item" data-page="deposit-page"><i class="fas fa-wallet"></i><span>Deposit</span></button>
        <button class="nav-item" data-page="lottery-page"><i class="fas fa-ticket-alt"></i><span>Lottery</span></button>
        <button class="nav-item" data-page="tasks-page"><i class="fas fa-tasks"></i><span>Tasks</span></button>
    </nav>
    
    <!-- Modals & Notifications -->
    <div id="instructions-modal" class="modal-overlay"><div class="modal-content"><button class="modal-close-btn">&times;</button><h3 style="color: var(--accent-primary);">How To Mine</h3><div id="instructions-content"></div></div></div>
    <div id="video-modal" class="modal-overlay"><div class="modal-content"><button class="modal-close-btn">&times;</button><iframe id="video-iframe" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div></div>
    <div id="welcome-notice-modal" class="modal-overlay"><div class="modal-content"><img id="welcome-image" src=""><h2 id="welcome-title"></h2><p id="welcome-description"></p><div id="welcome-join-buttons"></div><button id="welcome-close-btn" class="btn">I Understand</button></div></div>
    <div id="task-modal" class="modal-overlay"><div class="modal-content"><h2 id="task-title">Complete Task</h2><p id="task-description"></p><div id="task-timer">0</div><a id="task-link-btn" href="#" target="_blank" class="btn">Go to Task</a><button id="task-claim-btn" class="btn" disabled>Claim Reward</button></div></div>
    <div id="privacy-modal" class="modal-overlay"><div class="modal-content"><button class="modal-close-btn">&times;</button><h3 style="color: var(--accent-primary);">Privacy Policy</h3><div id="privacy-content"></div></div></div>
    <div id="terms-modal" class="modal-overlay"><div class="modal-content"><button class="modal-close-btn">&times;</button><h3 style="color: var(--accent-primary);">Terms & Conditions</h3><div id="terms-content"></div></div></div>
    <div id="lottery-purchase-modal" class="modal-overlay"><div class="modal-content"><button class="modal-close-btn">&times;</button><h3>Confirm Purchase</h3><p id="purchase-modal-text"></p><div style="display:flex; gap:10px;"><button id="cancel-purchase-btn" class="btn" style="background:var(--error-color);">Cancel</button><button id="confirm-purchase-btn" class="btn">Confirm</button></div></div></div>
    <div id="notification" class="notification"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.16.0/firebase-app.js";
        import { getDatabase, ref, onValue, get, update, increment, serverTimestamp, push, query, orderByChild, equalTo, startAt } from "https://www.gstatic.com/firebasejs/9.16.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCrWhN-Zo4KUEWwbSOqpy4pHRB8Lr8M6kQ",
            authDomain: "earn-view-cf5b6.firebaseapp.com",
            databaseURL: "https://earn-view-cf5b6-default-rtdb.firebaseio.com",
            projectId: "earn-view-cf5b6",
        };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        
        let tg = null, currentUserId = null, currentUserName = "Guest", miningSettings = {}, miningState = { count: 0, lastMineTimestamp: 0 }, isMining = false;
        let depositSettings = {}, lotterySettings = {}, currentUserData = {};
        const COIN_ICON_URL = "https://i.ibb.co/Qjjn0jt4/1000105515.jpg";

        // --- GLOBAL INITIALIZATION ---
        function globalInit() {
            try { tg = window.Telegram.WebApp; tg.expand(); } catch (e) { console.warn("Running in guest mode."); }
            
            if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) {
                initializeUser(tg.initDataUnsafe.user);
            } else {
                initializeGuest();
            }

            attachGlobalEventListeners();
            applyTheme(localStorage.getItem('theme') || 'dark');
            
            // Initialize all pages
            initMiningPage();
            initGiftPage();
            initDepositPage();
            initLotteryPage();
            initTasksPage();
        }

        function initializeUser(tgUser) {
            currentUserId = tgUser.id.toString();
            currentUserName = `${tgUser.first_name || ''} ${tgUser.last_name || ''}`.trim();
            document.getElementById('user-name').textContent = currentUserName;
            document.getElementById('user-id').textContent = `ID: ${currentUserId}`;

            onValue(ref(db, `users/${currentUserId}`), (snap) => {
                if(!snap.exists()) {
                    const newUser = {
                        name: currentUserName, registeredAt: serverTimestamp(),
                        wallets: { main: 0, todayMining: 0, totalMining: 0, todayEarning: 0, task: 0, ads: 0, bonus: 0, lottery: 0, referral: 0, transfer: 0, deposit: 0, lotteryWinnings: 0, totalGiftCoins: 0 },
                        spentBalance: 0, lotteriesPurchased: 0,
                    };
                    update(ref(db, `users/${currentUserId}`), newUser);
                    currentUserData = newUser;
                } else {
                    currentUserData = snap.val();
                }
                updateAllBalances(currentUserData.wallets || {});
                document.getElementById('profile-pic').src = currentUserData.profilePic || 'https://i.ibb.co/L0xJ182/placeholder.png';
            });
        }
        
        function initializeGuest() {
            document.getElementById('user-name').textContent = "Guest User";
            document.getElementById('user-id').textContent = "Welcome!";
        }

        function updateAllBalances(wallets = {}) {
            const format = (v) => (v || 0).toLocaleString();
            // Mining Page Balances
            document.getElementById('today-mining-balance').textContent = format(wallets.todayMining);
            document.getElementById('total-mining-balance').textContent = format(wallets.totalMining);
            document.getElementById('today-earning-balance').textContent = format(wallets.todayEarning);
            document.getElementById('main-balance').textContent = format(wallets.main);
            document.getElementById('task-earning-balance').textContent = format(wallets.task);
            document.getElementById('ads-earning-balance').textContent = format(wallets.ads);
            document.getElementById('bonus-earning-balance').textContent = format(wallets.bonus);
            document.getElementById('lottery-earning-balance').textContent = format(wallets.lottery);
            document.getElementById('referral-balance').textContent = format(wallets.referral);
            document.getElementById('transfer-balance').textContent = format(wallets.transfer);
            // Gift Page Balances
            document.getElementById('my-total-coins').textContent = format(wallets.totalGiftCoins);
            // Deposit Page Balances
            document.getElementById('deposit-balance').textContent = format(wallets.deposit);
            document.getElementById('spent-balance').textContent = format(currentUserData.spentBalance || 0);
            // Lottery Page Balances
            document.getElementById('lottery-winnings-balance').textContent = format(wallets.lotteryWinnings);
            document.getElementById('total-lotteries-purchased').textContent = format(currentUserData.lotteriesPurchased || 0);
        }
        
        function attachGlobalEventListeners() {
            // Theme Switcher
            document.getElementById('theme-switcher').addEventListener('click', () => applyTheme(document.body.classList.contains('light-mode') ? 'dark' : 'light'));

            // Bottom Navigation
            document.querySelector('.bottom-nav').addEventListener('click', (e) => {
                const navItem = e.target.closest('.nav-item');
                if (navItem) {
                    document.querySelector('.nav-item.active').classList.remove('active');
                    navItem.classList.add('active');
                    document.querySelector('.page.active').classList.remove('active');
                    document.getElementById(navItem.dataset.page).classList.add('active');
                }
            });

            // Modal Close Buttons
            document.querySelectorAll('.modal-close-btn').forEach(btn => {
                btn.addEventListener('click', () => btn.closest('.modal-overlay').classList.remove('show'));
            });
        }

        function showNotification(message, isError = false) {
            const el = document.getElementById('notification');
            el.textContent = message;
            el.style.backgroundColor = isError ? 'var(--error-color)' : 'var(--success-color)';
            el.classList.add('show');
            setTimeout(() => el.classList.remove('show'), 3000);
        }

        function applyTheme(theme) { 
            document.body.classList.toggle('light-mode', theme === 'light'); 
            localStorage.setItem('theme', theme); 
        }

        // --- MINING PAGE LOGIC ---
        function initMiningPage() {
            fetchMiningSettings();
            attachMiningEventListeners();
        }

        async function fetchMiningSettings() {
            const settingsSnap = await get(ref(db, 'appSettings/miningPage'));
            if (!settingsSnap.exists()) return;
            const settings = settingsSnap.val();
            miningSettings = settings; // Store all settings
            
            document.getElementById('instructions-content').innerHTML = (settings.instructions || "N/A").replace(/\n/g, '<br>');
            document.getElementById('privacy-content').innerHTML = (settings.privacyPolicy || "N/A").replace(/\n/g, '<br>');
            document.getElementById('terms-content').innerHTML = (settings.terms || "N/A").replace(/\n/g, '<br>');
            if(settings.autoRobotEnabled) document.getElementById('auto-mine-btn').style.display = 'flex';
            document.getElementById('video-thumbnail').dataset.videoId = settings.youtubeVideoId || 'dQw4w9WgXcQ';
            document.getElementById('video-thumbnail').querySelector('img').src = `https://img.youtube.com/vi/${settings.youtubeVideoId || 'dQw4w9WgXcQ'}/0.jpg`;
            document.getElementById('mine-now-btn').innerHTML = `Mine Now (+${settings.reward || 10})`;
            document.getElementById('ref-code-input').value = currentUserId;
            if(settings.referralBaseUrl && currentUserId) document.getElementById('ref-link-input').value = `${settings.referralBaseUrl}?ref=${currentUserId}`;
            
            const socialContainer = document.getElementById('social-icons');
            socialContainer.innerHTML = '';
            const iconMap = { facebook: 'fa-facebook', twitter: 'fa-twitter', instagram: 'fa-instagram', telegram: 'fa-telegram', youtube: 'fa-youtube', discord: 'fa-discord', linkedin: 'fa-linkedin', reddit: 'fa-reddit-alien', pinterest: 'fa-pinterest' };
            for(const [name, data] of Object.entries(settings.socialLinks || {})){
                if(iconMap[name]) socialContainer.innerHTML += `<a href="${data.link}" target="_blank"><i class="fab ${iconMap[name]}"></i></a>`;
            }
            
            if(settings.welcomeNotice?.enabled) showWelcomeNotice(settings.welcomeNotice);

            const stateSnap = await get(ref(db, `miningStats/${currentUserId}`));
            if(stateSnap.exists()) miningState = stateSnap.val();
            checkRestPeriod();
        }

        function showWelcomeNotice(notice) {
            document.getElementById('welcome-image').src = notice.imageUrl;
            document.getElementById('welcome-title').textContent = notice.title;
            document.getElementById('welcome-description').textContent = notice.description;
            const buttonsContainer = document.getElementById('welcome-join-buttons');
            buttonsContainer.innerHTML = '';
            if(notice.joinButtons) notice.joinButtons.forEach(btnData => buttonsContainer.innerHTML += `<a href="${btnData.link}" target="_blank" class="btn">${btnData.text}</a>`);
            document.getElementById('welcome-close-btn').onclick = () => {
                if(notice.closeButtonLink) window.open(notice.closeButtonLink, '_blank');
                document.getElementById('welcome-notice-modal').classList.remove('show');
            };
            document.getElementById('welcome-notice-modal').classList.add('show');
        }
        
        function checkRestPeriod() {
            const timeSinceLastMine = Date.now() - miningState.lastMineTimestamp;
            const restTimeSeconds = miningSettings.restDuration;
            if (miningState.count >= miningSettings.minesPerCycle && timeSinceLastMine < restTimeSeconds * 1000) {
                isMining = true;
                document.getElementById('mine-now-btn').disabled = true;
                let timeLeft = Math.ceil((restTimeSeconds * 1000 - timeSinceLastMine) / 1000);
                const timerInterval = setInterval(() => {
                    document.getElementById('mine-now-btn').textContent = `Rest: ${timeLeft--}s`;
                    if (timeLeft < 0) {
                        clearInterval(timerInterval);
                        isMining = false;
                        document.getElementById('mine-now-btn').innerHTML = `Mine Now (+${miningSettings.reward})`;
                        document.getElementById('mine-now-btn').disabled = false;
                    }
                }, 1000);
            }
        }
        
        function handleMine() { /* ... same as your original ... */ }
        async function claimMineReward(isTaskReward = false) { /* ... same as your original ... */ }
        function showTaskModal() { /* ... same as your original ... */ }

        function attachMiningEventListeners() {
            document.getElementById('mine-now-btn').addEventListener('click', handleMine);
            document.getElementById('instructions-btn').addEventListener('click', () => document.getElementById('instructions-modal').classList.add('show'));
            document.getElementById('video-thumbnail').addEventListener('click', (e) => {
                const videoId = e.currentTarget.dataset.videoId;
                if (videoId) {
                    document.getElementById('video-iframe').src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
                    document.getElementById('video-modal').classList.add('show');
                }
            });
            document.getElementById('video-modal').querySelector('.modal-close-btn').addEventListener('click', () => {
                document.getElementById('video-iframe').src = '';
                document.getElementById('video-modal').classList.remove('show');
            });
            document.querySelectorAll('.copy-btn').forEach(btn => btn.addEventListener('click', (e) => {
                const input = document.getElementById(e.currentTarget.dataset.target);
                navigator.clipboard.writeText(input.value).then(() => showNotification("Copied!"));
            }));
            document.getElementById('privacy-policy-link').addEventListener('click', (e) => { e.preventDefault(); document.getElementById('privacy-modal').classList.add('show'); });
            document.getElementById('terms-link').addEventListener('click', (e) => { e.preventDefault(); document.getElementById('terms-modal').classList.add('show'); });
        }


        // --- GIFT PAGE LOGIC ---
        function initGiftPage() {
            attachGiftEventListeners();
            loadGiftPageData();
        }

        function loadGiftPageData() {
            if (!currentUserId) return;
            loadLeaderboard();
            loadTodayStats();
        }

        async function handleClaim(e) { /* ... same as your original ... */ }
        
        function renderGiftHistory(claims, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            if (!claims || claims.length === 0) {
                container.innerHTML = '<p style="text-align:center; color: var(--text-secondary);">No data available.</p>'; return;
            }
            let content = '';
            claims.forEach(data => {
                content += `<div class="history-list-item">...</div>`; // Use your original template
            });
            container.innerHTML = content;
        }

        async function loadTodayStats() { /* ... same as your original ... */ }
        async function loadLeaderboard() { /* ... same as your original ... */ }
        async function loadMyHistory() { /* ... same as your original ... */ }
        
        function attachGiftEventListeners() {
            document.getElementById('claim-form').addEventListener('submit', handleClaim);
            document.getElementById('leaderboard-btn').addEventListener('click', () => {
                document.getElementById('leaderboard-btn').classList.add('active');
                document.getElementById('my-history-btn').classList.remove('active');
                loadLeaderboard();
            });
            document.getElementById('my-history-btn').addEventListener('click', () => {
                document.getElementById('my-history-btn').classList.add('active');
                document.getElementById('leaderboard-btn').classList.remove('active');
                loadMyHistory();
            });
        }


        // --- DEPOSIT PAGE LOGIC ---
        function initDepositPage() {
            fetchDepositSettings();
            attachDepositEventListeners();
            loadDepositHistory();
        }
        
        async function fetchDepositSettings() { /* ... same as your original ... */ }
        function loadDepositHistory() { /* ... same as your original ... */ }
        function loadSpendingHistory() { /* ... same as your original ... */ }

        function attachDepositEventListeners() {
            document.getElementById('deposit-now-btn').addEventListener('click', () => {
                document.getElementById('deposit-main-view').style.display = 'none';
                document.getElementById('deposit-form-view').style.display = 'block';
                goToStep(1);
            });
            document.getElementById('back-to-deposit-main').addEventListener('click', () => {
                 document.getElementById('deposit-main-view').style.display = 'block';
                document.getElementById('deposit-form-view').style.display = 'none';
            });
            // Other listeners from your original file
        }
        function goToStep(stepNumber) { /* ... same as your original ... */ }


        // --- LOTTERY PAGE LOGIC ---
        function initLotteryPage() {
            fetchLotterySettings();
            fetchLotteries();
            attachLotteryEventListeners();
        }

        async function fetchLotterySettings() { /* ... same as your original ... */ }
        async function fetchLotteries() { /* ... same as your original ... */ }
        function renderLotteryCard(lottery, lotteryId) { /* ... same as your original ... */ }
        function handlePurchaseClick(dataset) { /* ... same as your original ... */ }
        async function confirmPurchase(lotteryId, price, paymentSource) { /* ... same as your original ... */ }

        function attachLotteryEventListeners() {
            document.getElementById('lottery-list').addEventListener('click', e => {
                if (e.target.classList.contains('purchase-btn')) handlePurchaseClick(e.target.dataset);
            });
            // Other listeners
        }
        

        // --- SUPER TASKS PAGE LOGIC ---
        function initTasksPage() {
            loadTasks();
            loadTasksHistory();
            attachTasksEventListeners();
        }
        async function loadTasks() { /* ... same as your original ... */ }
        function showDetailsPage(taskId) { /* ... same as your original ... */ }
        async function handleTaskSubmission(event) { /* ... same as your original ... */ }
        function loadTasksHistory() { /* ... same as your original ... */ }
        
        function attachTasksEventListeners() {
            document.getElementById('back-to-tasks-main').addEventListener('click', () => {
                 document.getElementById('tasks-main-view').style.display = 'block';
                 document.getElementById('tasks-details-view').style.display = 'none';
            });
            // Other listeners
        }
        
        // --- START THE APP ---
        globalInit();
    </script>
</body>
</html>